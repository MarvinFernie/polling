exports.id=968,exports.ids=[968],exports.modules={7854:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,2994,23)),Promise.resolve().then(r.t.bind(r,6114,23)),Promise.resolve().then(r.t.bind(r,9727,23)),Promise.resolve().then(r.t.bind(r,9671,23)),Promise.resolve().then(r.t.bind(r,1868,23)),Promise.resolve().then(r.t.bind(r,4759,23))},4221:(e,t,r)=>{Promise.resolve().then(r.bind(r,4545))},7719:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var s=r(326),o=r(7577);function i(e){return 0===e?"0 votes":1===e?"1 vote":`${e} votes`}function l(e,t){return 0===t?0:Math.round(e/t*100)}var n=r(4545);function a({poll:e,initialVoted:t=!1,initialUpvoted:a=!1}){let{userId:d}=(0,n.a)(),[c,u]=(0,o.useState)(t),[p,m]=(0,o.useState)(a),[h,x]=(0,o.useState)(null),[v,b]=(0,o.useState)(e),[f,g]=(0,o.useState)(!1),w=v.options.reduce((e,t)=>e+t.votes,0),j=async()=>{if(h&&!c&&!f&&d){g(!0);try{let{vote:e}=await Promise.resolve().then(r.bind(r,6499));await e(d,v.id,h)&&(localStorage.setItem(`poll_vote_${v.id}`,h),u(!0),b(e=>{let t=e.options.map(e=>e.id===h?{...e,votes:e.votes+1}:e);return{...e,options:t}}))}catch(e){console.error("Error submitting vote:",e)}finally{g(!1)}}},y=async()=>{if(!p&&!f&&d){g(!0);try{let{upvotePoll:e}=await Promise.resolve().then(r.bind(r,6499));await e(d,v.id)&&(localStorage.setItem(`poll_upvote_${v.id}`,"true"),m(!0),b(e=>({...e,upvotes:e.upvotes+1})))}catch(e){console.error("Error upvoting poll:",e)}finally{g(!1)}}};return(0,s.jsxs)("div",{className:"card overflow-hidden transform transition-all duration-300 hover:translate-y-[-2px] animate-fade-in",children:[(0,s.jsxs)("div",{className:"flex justify-between items-start mb-6",children:[s.jsx("h3",{className:"text-xl font-semibold text-white",children:v.question}),(0,s.jsxs)("button",{onClick:y,disabled:p||f,className:`flex items-center space-x-2 px-3 py-1.5 rounded-full text-sm transition-all duration-300 
            ${p?"bg-accent-subtle text-accent-light border border-accent/30":"hover:bg-accent-subtle/50 border border-transparent hover:border-accent/20 text-gray-400 hover:text-accent"}`,children:[s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-4 w-4 transition-transform duration-300 ${p?"text-accent":"group-hover:translate-y-[-1px]"}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})}),s.jsx("span",{children:v.upvotes})]})]}),s.jsx("div",{className:"space-y-3 mb-6",children:v.options.map(e=>s.jsx("div",{className:"space-y-2",children:c?(0,s.jsxs)("div",{className:"p-4 rounded-xl border border-border bg-surface",children:[(0,s.jsxs)("div",{className:"flex justify-between mb-2",children:[s.jsx("span",{className:"font-medium text-gray-200",children:e.text}),(0,s.jsxs)("span",{className:"text-accent font-medium",children:[l(e.votes,w),"%"]})]}),s.jsx("div",{className:"w-full bg-surface-light rounded-full h-3 overflow-hidden",children:s.jsx("div",{className:"h-3 rounded-full bg-gradient-to-r from-accent to-accent-light transition-all duration-1000 ease-out",style:{width:`${l(e.votes,w)}%`}})}),(0,s.jsxs)("div",{className:"mt-1 text-xs text-gray-500",children:[e.votes," ",1===e.votes?"vote":"votes"]})]}):s.jsx("button",{onClick:()=>x(e.id),className:`w-full text-left p-4 rounded-xl border transition-all duration-300 
                ${h===e.id?"border-accent bg-accent-subtle shadow-subtle":"border-border bg-surface hover:border-border-light hover:bg-surface-light"}`,children:(0,s.jsxs)("div",{className:"flex items-center",children:[s.jsx("div",{className:`w-5 h-5 rounded-full border ${h===e.id?"border-accent bg-accent":"border-border"} mr-3 flex items-center justify-center transition-all duration-300`,children:h===e.id&&s.jsx("svg",{className:"w-3 h-3 text-white",viewBox:"0 0 20 20",fill:"currentColor",children:s.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})}),s.jsx("span",{className:`${h===e.id?"text-accent-light":"text-gray-300"} transition-colors duration-300`,children:e.text})]})})},e.id))}),!c&&(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-4 mt-4 pt-4 border-t border-border",children:[s.jsx("span",{className:"text-sm text-gray-400",children:i(w)}),s.jsx("button",{onClick:j,disabled:!h||f,className:`btn-primary w-full sm:w-auto flex items-center justify-center ${!h||f?"opacity-50 cursor-not-allowed":""}`,children:f?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Submitting..."]}):(0,s.jsxs)(s.Fragment,{children:[s.jsx("svg",{className:"mr-2 h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:s.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"Submit Vote"]})})]}),c&&(0,s.jsxs)("div",{className:"flex items-center mt-4 pt-4 border-t border-border text-sm text-gray-400",children:[s.jsx("svg",{className:"h-4 w-4 text-accent mr-2",viewBox:"0 0 20 20",fill:"currentColor",children:s.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),(0,s.jsxs)("span",{children:["You voted - ",i(w)]})]})]})}},4545:(e,t,r)=>{"use strict";r.d(t,{UserProvider:()=>l,a:()=>n});var s=r(326),o=r(7577);let i=(0,o.createContext)(void 0);function l({children:e}){let[t,r]=(0,o.useState)(""),[l,n]=(0,o.useState)(!1);return l?s.jsx(i.Provider,{value:{userId:t},children:e}):null}function n(){let e=(0,o.useContext)(i);if(void 0===e)throw Error("useUser must be used within a UserProvider");return e}},6499:(e,t,r)=>{"use strict";r.d(t,{mB:()=>d,upvotePoll:()=>u,vote:()=>c,wi:()=>a});var s=r(445),o=r(76);if(!s.db)throw Error("Firestore is not initialized");let i=(0,o.collection)(s.db,"polls"),l=(0,o.collection)(s.db,"userVotes"),n=(0,o.collection)(s.db,"userUpvotes");async function a(e){if(!s.db)throw Error("Firestore is not initialized");let t=e.options.map(e=>({id:Math.random().toString(36).substring(2,15),text:e,votes:0}));return(await (0,o.ET)(i,{question:e.question,options:t,upvotes:0,createdAt:Date.now()})).id}async function d(e=20){if(!s.db)throw Error("Firestore is not initialized");try{if(console.log("Querying Firestore for polls..."),!s.db)return console.error("Firestore db is not initialized"),[];let t=(0,o.query)(i,(0,o.Xo)("upvotes","desc"),(0,o.limit)(e)),r=await (0,o.getDocs)(t);return console.log(`Found ${r.docs.length} polls`),r.docs.map(e=>{let t=e.data();return{id:e.id,question:t.question||"",options:t.options||[],upvotes:t.upvotes||0,createdAt:t.createdAt||Date.now()}})}catch(e){return console.error("Error getting polls:",e),[]}}async function c(e,t,r){if(!s.db)throw Error("Firestore is not initialized");if(!s.db)return console.error("Firebase DB not initialized"),!1;let i=(0,o.query)(l,(0,o.ar)("userId","==",e),(0,o.ar)("pollId","==",t));if(!(await (0,o.getDocs)(i)).empty)return!1;let n=(0,o.JU)(s.db,"polls",t),a=await (0,o.QT)(n);if(!a.exists())return!1;let d=a.data().options,c=d.findIndex(e=>e.id===r);return -1!==c&&(d[c].votes=d[c].votes+1,await (0,o.r7)(n,{options:d}),await (0,o.ET)(l,{userId:e,pollId:t,optionId:r,votedAt:Date.now()}),!0)}async function u(e,t){if(!s.db)throw Error("Firestore is not initialized");let r=(0,o.query)(n,(0,o.ar)("userId","==",e),(0,o.ar)("pollId","==",t));if(!(await (0,o.getDocs)(r)).empty)return!1;let i=(0,o.JU)(s.db,"polls",t);return!!(await (0,o.QT)(i)).exists()&&(await (0,o.r7)(i,{upvotes:(0,o.nP)(1)}),await (0,o.ET)(n,{userId:e,pollId:t,upvotedAt:Date.now()}),!0)}},445:(e,t,r)=>{"use strict";r.d(t,{db:()=>a});var s=r(2585),o=r(76),i=r(6791);let l={apiKey:"AIzaSyBtesting123456789",authDomain:"social-poll-app.firebaseapp.com",projectId:"social-poll-app",storageBucket:"social-poll-app.appspot.com",messagingSenderId:"123456789",appId:"1:123456789:web:abcdef123456"};console.log("Firebase Config:",{apiKey:l.apiKey?.substring(0,5)+"...",projectId:l.projectId});let n=null,a=null;try{n=(0,s.C6)().length?(0,s.Mq)():(0,s.ZF)(l),a=(0,o.ad)(n),(0,i.v0)(n),console.log("Firebase initialized successfully with project ID:",l.projectId)}catch(e){console.error("Error initializing Firebase:",e),n=null,a=null}},3578:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>d,metadata:()=>a});var s=r(9510),o=r(6713),i=r.n(o);r(5023);var l=r(8570);let n=(0,l.createProxy)(String.raw`/home/computeruse/Desktop/working_dir/polling/src/components/UserProvider.tsx#UserProvider`);(0,l.createProxy)(String.raw`/home/computeruse/Desktop/working_dir/polling/src/components/UserProvider.tsx#useUser`);let a={title:"Social Poll",description:"Create and answer polls in a social format",themeColor:"#101318"};function d({children:e}){return(0,s.jsxs)("html",{lang:"en",className:`${i().variable}`,children:[(0,s.jsxs)("head",{children:[s.jsx("link",{rel:"preconnect",href:"https://fonts.googleapis.com"}),s.jsx("link",{rel:"preconnect",href:"https://fonts.gstatic.com",crossOrigin:"anonymous"}),s.jsx("link",{href:"https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap",rel:"stylesheet"})]}),s.jsx("body",{className:"bg-background text-white antialiased",children:s.jsx("div",{className:"min-h-screen",children:s.jsx("main",{className:"max-w-5xl mx-auto px-4 sm:px-6 py-10",children:s.jsx(n,{children:e})})})})]})}},5023:()=>{}};